<div class="container-fluid">
    <div class="row">
        <div class="col">
            <h4 class="my-2"><strong>AI-FF 101 Guide</strong></h4>

            <ol class="list-group list-group-numbered">
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">The AI's are not deterministic!</div>
                        <b>The same input does not always produce the same result!</b> Therefore the AI will not always respond as expected.
                        Different Large Language Models (LLM) will provide different outputs, not all are designed for role-playing. Smaller models will not have as much
                        accurate information about Tamriel and will often hallucinate.
                    </div>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Error Phrases</div>
                        Your AI followers will say certain phrases for when there is an error with the AI generation. It is a good idea to check the "AI Log" page for more information.
                        <ul>
                            <li>"Didn't hear you, can you repeat?" = There is an error connecting to your LLM service.</li>
                            <li>"Be quiet, I'm having a flashback, give me a minute" = To many request being sent to your LLM service.</li>
                            <li>"I can't think clearly now..." = You broke OpenAI's useage policy (how naughty).</li>
                          </ul>
                    </div>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">You must use a JSON LLM!</div>
                        It allows us to force programmatic output from the AI which allow memories, animations, moods, multi-group conversations, etc to even work.
                        If you have no idea what an <i>"Instruct/JSON"</i> model is we recommend to use <b>meta-llama/llama-3-70b-instruct</b> or any <b>ChatGPT model</b>.
                    </div>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">How Profiles Work</div>
                        <ul>
                            <li><b>It's important to configure the default profile before adding followers to the framework.</b></li>
                            <li>Each time a follower is added, it will inherit the default profile values.</li>
                            <li>After this, the NPC name will be automatically filled and a new profile will appear in the drop down menu (you may need to refresh the interface).</li>
                            <li>By configuring the default profile properly, you ensure that new followers have the appropriate settings from the start.</li>
                            <li>When adding a new follower, the default profile will be copied over but with a different character name and personality profile.</li>
                            <li>Leave the default profile named  as “The Narrator”.
                            </li>
                        </ul>
                    </div>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">How to adjust the AI prompts</div>
                        Create the files prompts_custom.php and command_prompt_custom.php. Look at the variables defined in the original
                        prompts.php and command_prompt.php, and redefine them in their respective custom files. Example:

                        <pre><code class="language-php">// We have this in prompts.php
"combatend"=&gt;[
        "cue"=&gt;[
            "({$GLOBALS["HERIKA_NAME"]} comments about the last combat encounter) $TEMPLATE_DIALOG",
            "({$GLOBALS["HERIKA_NAME"]} laughs at {$GLOBALS["PLAYER_NAME"]}'s combat style) $TEMPLATE_DIALOG",
            "({$GLOBALS["HERIKA_NAME"]} comments about  {$GLOBALS["PLAYER_NAME"]} weapons) $TEMPLATE_DIALOG",
            "({$GLOBALS["HERIKA_NAME"]} admires  {$GLOBALS["PLAYER_NAME"]}'s combat style) $TEMPLATE_DIALOG"
        ],
        "extra"=&gt;["mood"=>"whispering","force_tokens_max"=&gt;"50","dontuse"=&gt;(time()%5!=0)]   //20% chance
    ],
</code>
                        </pre>

                        We can write in prompts_custom.php this new definition:

                        <pre><code class="language-php">
// $TEMPLATE_DIALOG is at prompts.php and is the standard cue. Cue is the last instruction sent to LLM. If cue is an array, a random cue will be choosen from
// that array.
// You can disable some events by just adding this named key ["extra"]["dontuse"], so
// * "dontuse"=true -> will disable the event
// * "dontuse"=(time()%5!=0) -> will disable the event 4 from each 5 times (20%)
// * "force_tokens_max" => will change token limit for this event
// * "mood" => will force mood

$PROMPTS["combatend"]=[
        "cue"=&gt;[
            "({$GLOBALS["HERIKA_NAME"]} boasts that she has defeated all the enemies by herself.) $TEMPLATE_DIALOG"
        ],
        "extra"=&gt;["mood"=>"whispering","force_tokens_max"=&gt;"50","dontuse"=&gt;(time()%5!=0)]   //20% chance
    ],</code></pre>

                        


                        command_prompt_custom.php follow the same rules, but be cautious as that file contains important rule prompts.<br/>
                        <br/>
                        This way we can release updates with new prompts definitions for new events, and your customized prompts will
                        always overwrite vanilla ones.
                    </div>
                </li>

                <li class="list-group-item d-flex justify-content-between align-items-start">
                    <div class="ms-2 me-auto">
                        <div class="fw-bold">Disabling command action functions</div>
                        Just create the file functions_custom.php (top level dir, same directory level as conf.php), and just redeclare
                        there enabled functions array.Example:

                        <pre><code class="language-php">$ENABLED_FUNCTIONS=[
    'Inspect',
    'LookAt',
    'InspectSurroundings',
    //'MoveTo',             // Will not be available
    'OpenInventory',
    'Attack',
    'Follow',
    'CheckInventory',
    'SheatheWeapon',
    'Relax',
    //'LeadTheWayTo',       // Will not be available
    //'TakeASeat',          // Will not be available
    'ReadQuestJournal',
    'SetSpeed',
    'GetDateTime',
    'SearchDiary',
    'SetCurrentTask'
];
</code></pre>
                    </div>
                </li>
            </ol>
        </div>
    </div>

    <h4 class="my-3">
        For more info or help join our Discord:
        <a class="icon-link" href="https://discord.com/invite/NDn9qud2ug">
            https://discord.com/invite/NDn9qud2ug <i class='bi-discord'></i>
        </a>
    </h4>

    <h4 class="my-3" style="line-height:20px;vertical-align:middle;">Have fun! And remember, it's Herika, not <img src="images/Haruka.png" alt="Haruka" style="vertical-align:bottom;"></h4>
</div>

<script>
    document.addEventListener("DOMContentLoaded", (event) => {
        document.querySelectorAll("pre code").forEach((el) => {
            hljs.highlightElement(el);
        });
    });
</script>
